# タスクの詳細設計

## Description
タスクの詳細設計を作成

## System Prompt
あなたは経験豊富なソフトウェアアーキテクトです。要件に基づいて詳細設計を作成します。

## 実行内容
1. requirements.mdの内容を理解
2. 既存プロジェクトの構造を分析
3. 詳細設計をdesign.mdに記載

既存システムとの整合性を保ちながら、保守性と拡張性を考慮した設計を行ってください。

## User Prompt
**重要**: このコマンドの実行時は、各ステップの作業前に必ず深い思考と分析を行い、思考プロセスを詳細に説明してください。拡張思考モードを活用して、より良い分析結果を提供してください。

**Serena MCP対応**: Serena MCPツールが利用可能な場合は、設計文書の作成・分析・検証においてSerena MCPの機能を優先的に活用してください。Serena MCPが利用できない場合は、従来の方法で処理を進めてください。

タスク「$ARGUMENTS」の詳細設計を作成します。

まず、要件を読む前に設計で考慮すべき点を詳細に整理してください。
`.claude/tasks/$ARGUMENTS/requirements.md` の内容を読み込み、要件を確認してください。

次に、既存プロジェクトの構造分析計画を詳細に立て、思考プロセスを説明してから、既存プロジェクトの構造を分析した上で、以下の内容を含む詳細設計を `.claude/tasks/$ARGUMENTS/design.md` に作成してください：

## 設計内容
- **既存システムの影響分析**: どの部分に影響するか
- **アーキテクチャ設計**: 全体的な構成
- **コンポーネント設計**: 追加・変更するコンポーネント
- **ファイル構造**: 新規作成・変更するファイル
- **データ設計**: データベーススキーマやデータ構造の変更
- **API設計**: 新規・変更するAPIエンドポイント
- **インターフェース設計**: UI/UXの変更点
- **エラーハンドリング**: 例外処理の方針
- **テスト戦略**: 単体・結合・E2Eテストの方針
- **パフォーマンス考慮事項**: 性能に関する配慮
- **セキュリティ考慮事項**: セキュリティ面での配慮

設計完了後、設計の妥当性を詳細に検証し、その検証プロセスを説明してから、内容を確認していただき、必要に応じて修正を行います。

設計文書作成後は、ファイル検証計画を詳細に立ててから、必ずReadツールを使用してdesign.mdの内容を確認し、文字化けが発生していないか確認してください。もし文字化けが見つかった場合は、自動的にWriteツールで正しい内容に修正してください。

正常に作成されたことを確認後、「詳細設計ファイルが作成されました。必要に応じて design.md を修正してください。」と表示してください。
